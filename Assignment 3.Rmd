---
title: "Assignment 3"
output: html_document
date: "2022-10-19"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}
library(tidyverse)
library(data.table)
library(ggfortify)
library(cluster)

log_tpm_counts <- fread("fixed_logged_normalized_counts.csv")

```


```{r}
# creating redundant dataset to make changes to
plusvar_log_tpm_counts <- log_tpm_counts

# adding variance as a column so we can grab our datasets for clustering
plusvar_log_tpm_counts$var <- apply(plusvar_log_tpm_counts[, 2:57], MARGIN=1, FUN=var, na.rm=TRUE)

# ordering by highest variance first
plusvar_log_tpm_counts <- plusvar_log_tpm_counts[order(-var)]

# breaking data into smaller sets for individual clustering
ten_log_tpm_counts <- plusvar_log_tpm_counts[1:10,1:57]
hundred_log_tpm_counts <- plusvar_log_tpm_counts[1:100,1:57]
onek_log_tpm_counts <- plusvar_log_tpm_counts[1:1000,1:57]
fivek_log_tpm_counts <- plusvar_log_tpm_counts[1:5000,1:57]
tenk_log_tpm_counts <- plusvar_log_tpm_counts[1:10000,1:57]
```

```{r}
library(factoextra)
# helps figure out optimal number of clusters for PAM per:
# https://mlforanalytics.com/2020/05/23/pam-clustering-using-r/
# fviz_nbclust(fivek_log_tpm_counts[,2:57], pam, method ="silhouette")+theme_minimal()
```

```{r}
# PAM for fivek dataset
fivek_pamResults <- pam(fivek_log_tpm_counts[,2:57], 2)
autoplot(fivek_pamResults, frame = TRUE, frame.type = 'norm')
#ggsave("fivek_pamresults.svg",last_plot())
```
```{r}
# PAM for ten dataset
ten_pamResults <- pam(ten_log_tpm_counts[,2:57], 2) # compare k = 1 & 2 (quite strange)
autoplot(ten_pamResults, frame = TRUE, frame.type = 'norm')
#ggsave("ten_pamresults.svg",last_plot())
```

```{r}
# PAM for hundred dataset
hundred_pamResults <- pam(hundred_log_tpm_counts[,2:57], 3) # compare k = 2 & 3 (quite strange)
autoplot(hundred_pamResults, frame = TRUE, frame.type = 'norm')
#ggsave("hundred_pamresults.svg",last_plot())
```
```{r}
# PAM for onek dataset
onek_pamResults <- pam(onek_log_tpm_counts[,2:57], 2) # compare k = 2 & 3 (quite strange)
autoplot(onek_pamResults, frame = TRUE, frame.type = 'norm')
#ggsave("onek_pamresults.svg",last_plot())
```

```{r}
# PAM for tenk dataset
tenk_pamResults <- pam(tenk_log_tpm_counts[,2:57], 2)
autoplot(tenk_pamResults, frame = TRUE, frame.type = 'norm')
#ggsave("tenk_pamresults.svg",last_plot())
```